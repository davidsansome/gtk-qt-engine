# -*-shell-script-*-

[Meta]
RootName: @freedesktop.org/gtkqtengine:$SOFTWAREVERSION
DisplayName: Gtk-Qt theme engine
ShortName: gtk-qt-engine
Maintainer: David Sansome <me@davidsansome.com>
Packager: David Sansome <me@davidsansome.com>
Summary: A GTK theme engine that mimics the active Qt style
SoftwareVersion: @VERSION@
InterfaceVersion: 0
AutopackageTarget: 1.0

[Description]
This engine is for use by GTK applications running in KDE. It applies all Qt settings to the GTK application and uses Qt style plugins directly.

[BuildPrepare]
#export APBUILD_BOGUS_DEPS='Xrandr Xmu GL Xcursor ICE png pthread SM X11 Xext Xrender art_lgpl art_lgpl_2 nsl resolv Xinerama util dl fontconfig freetype Xft expat'
#export APBUILD_STATIC='z Xrender'

prepareBuild

mkdir -p $build_root
# The make install puts files in places other than $build_root
# This line copies all the installed files into $build_root
for filename in `find $build_root/../../ -type f`; do cp -f $filename $build_root; done


[BuildUnprepare]
unprepareBuild

[Imports]
echo '*' | import

[Prepare]
require @kde.org/kdelibs 3.1
require @gtk.org/gtk 2

[Install]
outputStatus "Installing theme engine library..."
mkdirs "$PREFIX/lib/gtk-2.0/engines/"
copyFile --silent libqtengine.la "$PREFIX/lib/gtk-2.0/engines/libqtengine.la"
copyFile --silent libqtengine.so "$PREFIX/lib/gtk-2.0/engines/libqtengine.so"

outputStatus "Installing theme..."
mkdirs "$PREFIX/share/themes/Qt/gtk-2.0"
copyFile --silent gtkrc "$PREFIX/share/themes/Qt/gtk-2.0/gtkrc"

outputStatus "Installing KDE control center module..."
mkdirs "$PREFIX/lib/kde3"
copyFile --silent kcm_kcmgtk.so "$PREFIX/lib/kde3/kcm_kcmgtk.so"
copyFile --silent kcm_kcmgtk.la "$PREFIX/lib/kde3/kcm_kcmgtk.la"
installDesktop --no-path-adjust "Settings/LookNFeel" "kcmgtk.desktop"

updateEnv GTK_PATH "$PREFIX/lib/gtk-2.0"
updateEnv KDEDIRS "$PREFIX"

[Uninstall]
uninstallFromLog
